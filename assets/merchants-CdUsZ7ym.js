import{u as C,v as _,D as X,c as i,a as e,t as s,e as A,F as b,E as h,o as u,G as D,H as B,I as S}from"./index-FJ0MJ8vU.js";import{h as p}from"./axios-JFeCRDsi.js";const v="/merchants",V=()=>p.get(`${v}`),N=l=>p.post(v,l),E=l=>p.get(`${v}/${l}`),F=(l,d)=>p.patch(`${v}/${l}/${d}`),G=(l,d)=>p.put(`${v}/${l}`,d),H=l=>p.post(`${v}/${l}/admins`,{merchant_id:l}),I=(l,d)=>p.delete(`${v}/${l}/admins/${d}`),L={class:"p-4"},P={key:0},T={key:1},U={key:2},j={class:"space-y-4"},q={class:"text-lg font-semibold"},z=["onClick"],J=["onClick"],K=["onClick"],O=["onClick"],Q=["onClick"],R={key:0,class:"mt-6 border-t pt-4"},W={class:"space-y-1"},Y={class:"mt-4"},Z={class:"list-disc list-inside"},ee={class:"mt-4"},te={class:"list-disc list-inside"},ne=C({__name:"merchants",setup(l){const d=_([]),o=_(!0),y=_(""),m=async()=>{o.value=!0,y.value="";try{const n=await V();d.value=n.data.data}catch(n){y.value=n.message||"發生錯誤"}finally{o.value=!1}},f=async()=>{try{o.value=!0,await N({name:"西打藍好內容2",business_id:"93662834",contact_name:"frank2",contact_email:"sida.test03@gmail.com",contact_phone:"0912345678",address:"基隆市 XXXXX"}),await m(),alert("商戶建立成功")}catch(n){alert("建立失敗："+(n.message||""))}finally{o.value=!1}},r=_(null),k=async n=>{try{const a=await E(n);r.value=a.data.data}catch(a){alert("獲取商戶詳情失敗："+(a.message||""))}},g=_("active"),w=async n=>{try{o.value=!0,await F(n,g.value),console.log("商戶狀態已更新"),await m()}catch(a){console.log("更新失敗："+(a.message||""))}finally{o.value=!1}},x=async n=>{try{o.value=!0,await G(n,{name:"7-14",business_id:"3333333334",contact_name:"peter",contact_email:"121@gmail.com",contact_phone:"0912345678",address:"基隆市 XXXXX"}),console.log("商戶資料已更新"),await m()}catch(a){console.log("更新失敗："+(a.message||""))}finally{o.value=!1}},M=async n=>{try{o.value=!0,await H(n),await m(),alert("新增管理員成功")}catch(a){alert("新增失敗："+(a.message||""))}finally{o.value=!1}},$=async(n,a)=>{try{o.value=!0,await I(n,a),await m(),alert("已刪除管理員")}catch(t){alert("刪除失敗："+(t.message||""))}finally{o.value=!1}};return X(async()=>{m()}),(n,a)=>(u(),i("div",L,[a[6]||(a[6]=e("h2",{class:"text-xl font-bold mb-4"},"商戶列表",-1)),e("button",{class:"mb-4 bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-4 rounded",onClick:f}," 創建商戶 "),o.value?(u(),i("div",P,"載入中...")):y.value?(u(),i("div",T,s(y.value),1)):(u(),i("div",U,[e("ul",j,[(u(!0),i(b,null,h(d.value,t=>(u(),i("li",{key:t.id,class:"border p-4 rounded-md shadow"},[e("h3",q,s(t.name),1),e("p",null,"統一編號："+s(t.business_id),1),e("p",null,"狀態："+s(t.status),1),e("p",null,"聯絡人："+s(t.contact_name)+"（"+s(t.contact_email)+" / "+s(t.contact_phone)+"）",1),e("p",null,"地址："+s(t.address),1),e("p",null," 訂閱期間："+s(t.subscription_start_date)+" ~ "+s(t.subscription_end_date),1),e("p",null,[a[1]||(a[1]=B(" 管理員： ")),(u(!0),i(b,null,h(t.admins,c=>(u(),i("span",{key:c.id},s(c.username)+"（"+s(c.email)+"） ",1))),128))]),e("button",{class:"mt-2 mr-2 bg-green-500 hover:bg-green-600 text-white px-3 py-1 rounded",onClick:c=>k(t.id)}," 獲取商戶詳情 ",8,z),e("button",{class:"mt-2 mr-2 bg-yellow-500 hover:bg-yellow-600 text-white px-3 py-1 rounded",onClick:c=>w(t.id)}," 更新商戶狀態 ",8,J),D(e("select",{"onUpdate:modelValue":a[0]||(a[0]=c=>g.value=c),class:"mt-2 mr-2 mb-2 px-2 py-1 border rounded"},a[2]||(a[2]=[e("option",{value:"active"},"啟用",-1),e("option",{value:"inactive"},"停用",-1),e("option",{value:"suspended"},"暫停",-1)]),512),[[S,g.value]]),e("button",{class:"mt-2 mr-2 bg-blue-500 hover:bg-green-600 text-white px-3 py-1 rounded",onClick:c=>x(t.id)}," 更新商戶資料 ",8,K),e("button",{class:"mt-2 mr-2 bg-purple-500 hover:bg-purple-600 text-white px-3 py-1 rounded",onClick:c=>M(t.id)}," 新增商戶管理員 ",8,O),e("button",{class:"mt-2 mr-2 bg-purple-500 hover:bg-purple-600 text-white px-3 py-1 rounded",onClick:c=>$(t.id,t.id)}," 刪除 ",8,Q)]))),128))]),r.value?(u(),i("div",R,[a[5]||(a[5]=e("h3",{class:"text-lg font-bold mb-2"},"商戶詳情",-1)),e("div",W,[e("p",null,"名稱："+s(r.value.name),1),e("p",null,"統一編號："+s(r.value.business_id),1),e("p",null,"狀態："+s(r.value.status),1),e("p",null," 聯絡人："+s(r.value.contact_name)+"（"+s(r.value.contact_email)+" / "+s(r.value.contact_phone)+"） ",1),e("p",null,"地址："+s(r.value.address),1),e("p",null,"訂閱期間："+s(r.value.subscription_start_date)+" ~ "+s(r.value.subscription_end_date),1)]),e("div",Y,[a[3]||(a[3]=e("h4",{class:"font-semibold mb-1"},"管理員",-1)),e("ul",Z,[(u(!0),i(b,null,h(r.value.admins,t=>(u(),i("li",{key:t.id},s(t.username)+"（"+s(t.email)+"） - "+s(t.MerchantAdmin.role),1))),128))])]),e("div",ee,[a[4]||(a[4]=e("h4",{class:"font-semibold mb-1"},"部門列表",-1)),e("ul",te,[(u(!0),i(b,null,h(r.value.departments,t=>(u(),i("li",{key:t.id},s(t.name)+" - "+s(t.description)+"｜主管："+s(t.manager.username)+"（"+s(t.manager.email)+"） ",1))),128))])])])):A("",!0)]))]))}});export{ne as default};
